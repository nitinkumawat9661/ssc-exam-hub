<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">âš™ï¸ Admin Control</h3>
        <a href="/dashboard" class="btn btn-secondary btn-sm">Back</a>
    </div>

    <div class="row g-3">
        <!-- ğŸ› ï¸ APP SETTINGS (Manage UPI & Email) -->
        <div class="col-md-6">
            <div class="card shadow-sm p-3 h-100">
                <h5 class="text-primary border-bottom pb-2">ğŸ”§ App Settings</h5>
                <form method="POST">
                    <input type="hidden" name="update_settings" value="true">
                    
                    <label class="small fw-bold">UPI ID (For Payments)</label>
                    <input type="text" name="upi_id" value="{{ settings.upi_id }}" class="form-control mb-2" required>
                    
                    <label class="small fw-bold">UPI Name</label>
                    <input type="text" name="upi_name" value="{{ settings.upi_name }}" class="form-control mb-2" required>
                    
                    <label class="small fw-bold">Admin Email (For Alerts)</label>
                    <input type="email" name="admin_email" value="{{ settings.admin_email }}" class="form-control mb-2" required>

                    <label class="small fw-bold">Notice Board Text</label>
                    <input type="text" name="notice_text" value="{{ settings.notice_text }}" class="form-control mb-2">
                    
                    <button type="submit" class="btn btn-primary w-100 mt-2">Save Settings âœ…</button>
                </form>
            </div>
        </div>

        <!-- ğŸ“„ UPLOAD PAPER -->
        <div class="col-md-6">
            <div class="card shadow-sm p-3 h-100">
                <h5 class="text-success border-bottom pb-2">ğŸ“„ Upload Material</h5>
                <form method="POST" enctype="multipart/form-data">
                    <input type="text" name="paper_title" class="form-control mb-2" placeholder="Title (e.g. History Notes)" required>
                    <input type="number" name="price" class="form-control mb-2" placeholder="Price (Coins)" value="50">
                    <input type="file" name="file" class="form-control mb-2" required>
                    <button type="submit" class="btn btn-success w-100">Upload PDF ğŸ“¤</button>
                </form>
            </div>
        </div>
    </div>

    <!-- ğŸ’¸ PENDING PAYMENTS -->
    <div class="card shadow-sm mt-4 p-3">
        <h5 class="text-warning">â³ Pending Payments</h5>
        {% if payments %}
        <div class="table-responsive">
            <table class="table table-bordered align-middle mt-2">
                <thead class="table-dark"><tr><th>User</th><th>Amount</th><th>UTR</th><th>Action</th></tr></thead>
                <tbody>
                    {% for pay in payments %}
                    <tr>
                        <td>{{ pay.user_name }}<br><small>{{ pay.user_id[:5] }}</small></td>
                        <td class="fw-bold">â‚¹{{ pay.amount }}</td>
                        <td><small>{{ pay.utr }}</small></td>
                        <td>
                            <a href="/approve_payment/{{ pay.id }}" class="btn btn-success btn-sm">Approve</a>
                            <a href="/reject_payment/{{ pay.id }}" class="btn btn-danger btn-sm">Reject</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-muted small">No pending requests.</p>
        {% endif %}
    </div>
</body>
</html>
